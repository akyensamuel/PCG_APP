{% extends 'base.html' %}
{% block content %}
<article class="max-w-3xl mx-auto prose prose-slate dark:prose-invert">
  <header class="mb-6">
    <h1 class="text-3xl font-bold">{{ event.title }}</h1>
    <div class="text-sm text-gray-600 dark:text-gray-300">
      <span>{{ event.start_date }}{% if event.end_date %} – {{ event.end_date }}{% endif %}</span>
      {% if event.start_time %}<span> • {{ event.start_time }}</span>{% endif %}
      {% if event.location %}<span> • {{ event.location }}</span>{% endif %}
      {% if event.group %}<span> • Group: {{ event.group.name }}</span>{% elif event.is_global %}<span> • Global</span>{% endif %}
    </div>
    {% if event.featured_image %}
      <img src="{{ event.featured_image.url }}" alt="Featured image" class="w-full rounded-lg shadow mt-4" />
    {% endif %}
  </header>
  <div class="leading-relaxed whitespace-pre-line">{{ event.body }}</div>

  {% if event.images.all %}
  <section class="mt-8">
    <h2 class="text-xl font-semibold mb-3">Gallery</h2>
    <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
      {% for img in event.images.all %}
        <figure>
          <img src="{{ img.image.url }}" alt="{{ img.caption }}" class="w-full rounded border" />
          {% if img.caption %}<figcaption class="text-xs text-gray-500 mt-1">{{ img.caption }}</figcaption>{% endif %}
        </figure>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  <footer class="mt-8 text-sm">
    <a class="underline" href="{% url 'events:calendar' %}">Back to calendar</a>
    {% if request.user.is_authenticated %}
      <span class="mx-2">·</span>
      <a class="underline" href="{% url 'events:edit' event.slug %}">Edit</a>
    {% endif %}
  </footer>
</article>
{% endblock %}
